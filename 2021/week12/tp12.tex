
\input{../header.tex}
\usepackage{array}
\newcolumntype{C}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}

\begin{document}
% Change the following values to true to show the solutions or/and the hints
\ShowSolutiontrue
\ShowConseiltrue
\titre
\cours{Programmation orientée objet - Exercices de base}

Le but de cette séance est de se familiariser avec un paradigme de programmation couramment utilisé: la Programmation Orientée Objet (POO). Ce paradigme consiste en la définition et en l'interaction avec des briques logicielles appelées \lstinline{Objets}. Dans les exercices suivants, nous manipulerons des objets, aborderons les notions de classe, méthodes, attributs et encapsulation. Au terme de cette séance, vous serez en mesure d'écrire des programmes mieux structurés.
Afin d'atteindre ces objectifs, nous utiliserons principalement le langage \lstinline{Java} qui offre une panoplie d'outils pour mieux comprendre ce paradigme de programmation.
\\
%TODO: Rajouter un lien vers les vidéos

Le code présenté dans les énoncés se trouvent sur Moodle, dans le dossier \lstinline{Ressources}.

\begin{comment}
    \begin{conseil}
        A partir de cette semaine, nous travaillerons de plus en plus en Java. Nous vous invitons donc à lire le guide de démarrage en Java qui se trouve sur 	Moodle:
        \url{https://moodle.unil.ch/mod/folder/view.php?id=1132337}.

        Une classe est un modèle pour l'objet. Avant de créer un objet, nous devons d'abord définir la classe.
        Nous pouvons considérer la classe comme le croquis (prototype) d'une maison. Elle contient tous les détails concernant les sols, les portes, les 	fenêtres, etc. Sur la base de ces descriptions, nous construisons la maison. La maison est l'objet.
        Puisque de nombreuses maisons peuvent être construites à partir de la même description, nous pouvons créer de nombreux objets à partir d'une classe.
        On peut créer une classe en Java en utilisant le mot-clé class. 
        Par exemple ;
        \lstinputlisting{ressources/Bicycle.java}
        Ici, les champs (fields) et les méthodes représentent respectivement l'état et le comportement de l'objet.
        Les champs sont utilisés pour stocker des données les méthodes sont utilisées pour effectuer certaines opérations.
    \end{conseil}
\end{comment}


\section{Création de votre première classe en Java}

Le but de cette première partie est de créer votre propre classe en Java. Cette classe sera une classe nommée \lstinline{Dog()} représentant un chien. Elle aura plusieurs attributs et méthodes que vous implémenterez au fur et à mesure.
\\

\begin{Exercice}[10 minutes] Création de classe et encapsulation\\
    Commencez par créer une nouvelle classe \lstinline{Java} dans votre projet. Ensuite, créez les attributs suivants :
    \begin{enumerate}
    \item Un attribut \lstinline{public} String nommé \lstinline{name}
    \item Un attribut \lstinline{private} List nommé \lstinline{tricks}
    \item Un attribut \lstinline{private} String nommé \lstinline{race}
    \item Un attribut \lstinline{private} int nommé \lstinline{age}
    \item Un attribut \lstinline{private} int nommé \lstinline{mood} initialisé à 5 (correspondant à l'humeur du chien)
    \item Un attribut de classe (\lstinline{static}) \lstinline{private} int nommé \lstinline{nb_chiens}
   	\end{enumerate}
   	
   	Créez une méthode publique du même nom que la classe (\lstinline{Dog}). Cette méthode est appelée le \lstinline{constructeur}, elle va servir à initialiser les différentes instances de notre classe. Un \lstinline{constructeur} en \lstinline{Java} aura le même nom que la classe, et le \lstinline{constructeur} en \lstinline{Python} sera défini par la méthode \lstinline{__init__}. Cette méthode prendra en argument les éléments suivants qui seront utilisés pour initialiser les attributs de notre instance :
   	\begin{enumerate}
    \item Une chaîne de caractère \lstinline{name},
    \item Une liste \lstinline{tricks},
    \item Une chaîne de caractère \lstinline{race},
    \item Un entier \lstinline{age}.
   	\end{enumerate}
   	
   	Pour finir, cette méthode doit incrémenter l'attribut de classe \lstinline{nb_chiens} qui va garder en mémoire le nombre d'instances crées.
   	
\begin{conseil}
    Pour revoir les notions de base du langage Java, n'hésitez pas à consulter le guide de démarrage en Java sur Moodle:
	\url{https://moodle.unil.ch/mod/folder/view.php?id=1132337}

   Pour cet exercice, n'oubliez pas de préciser si vos attributs sont \lstinline{public} ou \lstinline{private}.
   
   Le mot \lstinline{static} correspond à un élément de classe (attribut ou méthode), cet élément pourra ensuite être appelé via la classe directement.
   
   Pour attribuer des valeurs à vos attributs d'instance, utilisez le mot-clé \lstinline{this.attribut}.
   
   Pour accéder aux attributs de classe, utilisez \lstinline{nom_classe.nom_attribut}
\end{conseil}
    
\begin{solution}
	\lstinputlisting{ressources/Question1.java}
\end{solution}
\end{Exercice}

\begin{Exercice}[10 minutes] Getters et setters\\
    Il faut maintenant créer des méthodes de type \lstinline{getter} et \lstinline{setter} afin d'interagir avec les attributs \lstinline{private} des instances de la classe. 
    Les \lstinline{getters} renverront les attributs souhaités tandis que les \lstinline{setters} les modifieront.

    Les \lstinline{setters} sont souvent utilisés pour modifier la valeur d'attributs privés et ne renvoient rien.
    \begin{conseil}
        Exemple de \lstinline{getters} et de \lstinline{setters}:
        \lstinputlisting{ressources/Example.java}
    \end{conseil} 

    Vous pouvez directement accéder à des attributs publics en utilisant \lstinline{nom_instance.attribut} à l'intérieur ou à l'extérieur de la classe. \\
    
    Créez les méthodes suivantes :
    \begin{itemize}
    \item \lstinline{getTricks()}
    \item \lstinline{getRace()}
    \item \lstinline{getAge()}
    \item \lstinline{getMood()}
    \item \lstinline{setTricks()}
    \item \lstinline{setRace()}
    \item \lstinline{setAge()}
    \item \lstinline{setMood()}
    \end{itemize}
    
    Créez également une méthode de classe permettant de retourner le nombre de \lstinline{Dog} instanciés (un \lstinline{getter}).
   	
\begin{conseil}
    Intellij vous permet de générer automatiquement certaines méthodes telles que les getters et setters. Vous pouvez consulter le lien suivant pour plus d'informations: \url{https://www.jetbrains.com/help/idea/generating-code.html\#generate-delegation-methods}.
    \\
    Toutefois, pour cet exercice, nous vous encourageons à le faire manuellement.
\end{conseil}
    
\begin{solution}
	\lstinputlisting{ressources/Question2.java}
\end{solution}
\end{Exercice}

\begin{Exercice}[5 minutes] Manipulation d'attributs - Listes\\
    Créez une méthode publique nommée \lstinline{add_trick(String trick)} qui prend en entrée une chaîne de caractères et l'ajoute à la liste \lstinline{tricks}. \\
   	
\begin{conseil}
   La liste \lstinline{tricks} est une liste comme les autres. Si vous voulez la modifier, vous aurez besoin de passer par une \lstinline{LinkedList} temporaire.
\end{conseil}
    
\begin{solution}
	\lstinputlisting{ressources/Question3.java}
\end{solution}
\end{Exercice}

\begin{Exercice}[5 minutes] Manipulation d'attributs - \lstinline{setter}\\
    Créez deux méthodes permettant de modifier l'attribut \lstinline{mood} de l'objet \lstinline{Dog}. La méthode \lstinline{leash()} décrémentera \lstinline{mood} de 1 et \lstinline{eat()} l'incrémentera de 3. \\

\begin{solution}
	\lstinputlisting{ressources/Question4.java}
\end{solution}
\end{Exercice}

\begin{Exercice}[5 minutes] Manipulation d'attributs d'une autre instance\\
    Créez une méthode nommée \lstinline{get_oldest (Dog other)} qui prend comme argument un élément de type \lstinline{Dog}, puis retourne le nom et l'âge du chien le plus agé sous le format suivant : ``\lstinline{nom_chien} est le chien le plus agé avec \lstinline{age_chien} ans''. \\
   	
\begin{conseil}
   L'élément \lstinline{Dog} que vous passez en argument est un objet de type \lstinline{Dog}, vous pouvez donc lui appliquer les méthodes que vous avez créé tout à l'heure.
   Faites attention à la façon d'accéder aux différents attributs de votre deuxième chien (pour rappel, les attributs privés ne sont accessibles qu'à travers des \lstinline{getters} que vous aurez préalablement définis).
\end{conseil}
    
\begin{solution}
	\lstinputlisting{ressources/Question5.java}
\end{solution}
\end{Exercice}

\begin{Exercice}[5 minutes] Redéfinition de méthodes\\
    Créez une méthode \lstinline{toString()} de type \lstinline{public} qui retourne une chaîne de caractères contenant toutes les informations d'une instance de \lstinline{Dog}. Ainsi, dans votre \lstinline{main}, en faisant \lstinline{System.out.println(...)} sur une instance de \lstinline{Dog}, vous obtiendrez un texte sous le format suivant: 
    ``\lstinline{nom_chien} a \lstinline{age_chien} ans, est un \lstinline{race_chien} et a une humeur de \lstinline{mood_chien}. Il sait faire les tours suivants : \lstinline{tricks_chien}''.

    \begin{Example}{\faLightbulb \quad Informations utiles}
        La méthode \lstinline{toString()} hérite de la super classe \lstinline{Object}. La notion d'héritage sera présentée la semaine prochaine. Retenez juste qu'il est possible de choisir ce que vaudra le texte descriptif de nos objets de type \lstinline{Dog}. Il est également possible de redéfinir d'autres méthodes comme par exemple l'addition ou la soustraction, ce qui permettrait de choisir comment 2 objets de type \lstinline{Dog} seraient additionnés ou soustraits. \\
    \end{Example}

    \begin{solution}
        \lstinputlisting{ressources/Question6.java}
    \end{solution}
\end{Exercice}

Pour contrôler que vos méthodes et attributs ont été implémentés correctement, vous pouvez essayer le code suivant à l'intérieur de votre méthode \lstinline{main} :

	\lstinputlisting{ressources/question6_main.java}
	
Vous devriez obtenir ce résultat :
    \lstinputlisting{ressources/mainsolution.java}

\newpage
\section{Interaction entre plusieurs instances d'une même classe}
Dans cette section, nous allons simuler un jeu de combat entre deux protagonistes représentant des instances d'une classe \lstinline{Fighter} que nous allons créer.
Chaque \lstinline{Fighter} aura des attributs qui le définissent. Ces attributs sont:
\begin{itemize}
    \item \lstinline{nom:}\textit{(String)} chaque combattant sera identifié par un nom unique.
    \item \lstinline{health:}\textit{(int)} représentant le nombre de points de vie d'un combattant. Il contient des valeurs comprises entre 0 et 10. À l'instanciation de l'objet, le combattant a 10 points de vie par défaut-
    \item \lstinline{attaque:}\textit{(int)} représentant une valeur qui sera utilisée pour calculer le nombre de points de dégâts infligés à l'adversaire.
    \item \lstinline{défense:}\textit{(int)} représentant une valeur qui sera utilisée pour calculer le nombre de points de dégâts reçus.\\
\end{itemize}

Deux attributs de classe seront également utilisés :
\begin{itemize}
\item \lstinline{instances :} Liste comprenant les combattants qui ont été instanciés et qui sont toujours en vie.
\item \lstinline{attack_modifier :} Dictionnaire comportant 3 types d'attaques, chacune modifiant les dégâts qui vont être infligés. Les trois types d'attaques sont \lstinline{poing, pied et tête} modifiant respectivement l'attaque par 1, 2, 3.\\
\end{itemize}

Le but de cette partie est d'étudier les interactions entre deux instances d'une même classe. Cette classe se présentera sous la forme d'un \lstinline{Fighter}. Chaque instance de la classe \lstinline{Fighter} pourra attaquer les autres instances.
\\
Vous devrez compléter les 4 méthodes suivantes :
\begin{enumerate}
\item \lstinline{isAlive()}
\item \lstinline{checkDead()}
\item \lstinline{checkHealth()}
\item \lstinline{attack(String type, Fighter other)}\\
\end{enumerate}


Voici le squelette du code (à télécharger sur Moodle) :

\lstinputlisting{ressources/Combattant.java}

\begin{Exercice}[5 minutes] isAlive()\\
    Définir une méthode \lstinline{isAlive()} de type \lstinline{Boolean} qui retournera \lstinline{true} si l'instance a plus que 0 points de vie et \lstinline{false} si l'instance en a moins.

\begin{solution}
	\lstinputlisting{ressources/isalive.java}
\end{solution}
\end{Exercice}


\begin{Exercice}[10 minutes] checkDead()\\
    Définir une méthode \lstinline{checkDead()} qui parcourt la liste des instances, et contrôle que chacune d'entre elle est encore en vie. Si ce n'est pas le cas, l'instance en question est supprimée de la liste des instances et le message ``\lstinline{nom_instance} est mort'' sera affiché.
    
\begin{conseil}
Prenez le problème dans l'autre sens, créez une liste temporaire. Si l'instance est vivante, ajoutez la à cette nouvelle liste. Pour finir, mettez à jour votre liste d'instances à l'aide de votre liste temporaire.\\
L'attribut \lstinline{instances} étant une liste, vous pouvez parcourir cette liste d'instances en utilisant une boucle \lstinline{for}. 

\end{conseil}

\begin{solution}
	\lstinputlisting{ressources/checkdead.java}
\end{solution}
\end{Exercice}

\begin{Exercice}[5 minutes] checkHealth()\\
    Définir une méthode \lstinline{checkHealth()} qui parcourt la liste des instances et affiche le nombre de points de vie qui reste au combattant sous le format ``\lstinline{nom_instance} a encore \lstinline{health_instance} points de vie". 

\begin{solution}
	\lstinputlisting{ressources/checkhealth.java}
\end{solution}
\end{Exercice}

\begin{Exercice}[10 minutes] attack(String type Fighter other)\\
    Définir une méthode \lstinline{attack(String type, Fighter other)} qui permettra de retirer des points de vie au combattant \lstinline{other} en fonction de l'attaque de l'instance appelée, du type d'attaque sélectionné et de la défense de \lstinline{other}. \\
    
    Commencez par contrôler si \lstinline{other} est encore en vie.Si tel n'est pas le cas, indiquez qu'il est déjà mort : ``\lstinline{other_name} est déjà mort". \\

     Si \lstinline{other} est encore en vie, retirez des points de vie à \lstinline{other}. Le nombre de points de vie devant être retiré se calcule en utilisant la formule suivante : \lstinline{attack_modifier(type)} * \lstinline{attack_instance} - \lstinline{defense_other}. Appelez ensuite les fonctions \lstinline{checkDead()} et \lstinline{checkHealth()} afin d'avoir un aperçu des combattants restants et de leur santé.
    


\begin{solution}
	\lstinputlisting{ressources/attack.java}
\end{solution}
\end{Exercice}


Pour terminer, vous pouvez exécuter le code ci-dessous (disponible dans le dossier Ressources sur Moodle) pour vérifier que votre programme fonctionne correctement : \\

\lstinputlisting{ressources/main2.java}

Vous devriez obtenir ce résultat : \\

\lstinputlisting{ressources/main2solution.java}

\newpage

\section{Notions de POO en Python}
Dans cette section, nous créerons pas-à-pas une classe \lstinline{Point} contenant des attributs et des méthodes utiles.
Dans votre IDE, créez un nouveau projet Python (Fichier $>$ Nouveau $>$ Projet). Dans un dossier de votre choix, créez un fichier \lstinline{question11.py}.\\

\begin{Exercice}[15 minutes] Classe \lstinline{Point}
    \begin{itemize}
        \item Créez une classe \lstinline{Point} et un constructeur par défaut contenant deux paramètres (\lstinline{x} et \lstinline{y}).
        \begin{conseil}
            Pour rappel, un constructeur est une fonction \lstinline{__init()__} que vous redéfinirez dans votre classe.
        \end{conseil}
        \item Définissez deux attributs privés pour votre classe \lstinline{Point}. Ces attributs seront les coordonnées x et y de vos points. Par défaut, assignez leur les valeurs données dans le constructeur.
        \begin{conseil}
            À l'intérieur d'une classe, utilisez le mot-clé \lstinline{self} pour accéder aux méthodes et attributs de l'instance que vous manipulez.

            En Python, pour spécifier qu'un attribut est privé, rajouter un double underscore au nom de l'attribut (Exemple: \lstinline{__score=0})
        \end{conseil}
        \item Définir des getters et setters.
        \begin{conseil}
            En Python, le mot-clé \lstinline{self} est l'équivalent de \lstinline{this} utilisé en Java.
        \end{conseil}
        \item Définissez une méthode \lstinline{distance} qui prend en entrée l'instance du \lstinline{Point} (\lstinline{self}) et un autre \lstinline{Point} \lstinline{p2}. Cette méthode \lstinline{distance} retournera la distance euclidienne entre le point \lstinline{self} et \lstinline{p2}. 
        \begin{conseil}
            Pour rappel, la distance euclidienne entre deux points est définie par la formule $\sqrt{(x_1 - x_2)^2 + (y_1 - y_2)^2}$.

            Utilisez la fonction \lstinline{sqrt()} de la librairie \lstinline{math} pour calculer la racine carrée. Pensez à importer la libraire \lstinline{math}.
        \end{conseil}
        \item Définissez une méthode \lstinline{milieu} qui prendra en entrée \lstinline{self} et \lstinline{p2} et qui retournera un objet \lstinline{Point} situé entre \lstinline{self} et \lstinline{p2}.
        \begin{conseil}
            Pour trouver les coordonnées d'un point M($x_M$, $y_M$) situé au milieu du segment défini par des points A($x_A$, $y_A$) et B($x_B, y_B$),
            utilisez les formules suivantes:
            $x_M = \frac{x_1 + x_2}{2}$ et $y_M = \frac{y_1 + y_2}{2}$
        \end{conseil}

        \item Redéfinissez une méthode \lstinline{__str__()} dans la classe \lstinline{Point} qui retournera une chaîne de caractères contenant les coordonnées $(x,y)$ d'un point. Ainsi, lorsqu'on fera un \lstinline{print} d'une instance de la classe \lstinline{Point}, le message qui s'affichera sera le suivant:
        \textit{Les coordonnées du Point sont: x = "remplacez par la valeur de x" et y = "remplacez par la valeur de y"}
    \end{itemize}

\end{Exercice}

\begin{solution}
    \lstinputlisting{solutions/question11_solution.py}
\end{solution}

\end{document}
